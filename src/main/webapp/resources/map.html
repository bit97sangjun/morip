<!DOCTYPE html>
<html>
<head>
<meta charset="UTF-8">
<title>Insert title here</title>
</head>
<body>
	<h1>지도</h1>
	<div id="map" style="width:100%;height:400px;"></div>
	<script type="text/javascript" src="//dapi.kakao.com/v2/maps/sdk.js?appkey=43ebc80896d6b92c30a7a86d976b01f3"></script>
	<script>
		var container = document.getElementById('map');
		var options = {
			center: new daum.maps.LatLng(37.495123, 127.028271),
			level: 3
		};

		var map = new daum.maps.Map(container, options);
	</script>
	
	<script
        src="https://code.jquery.com/jquery-3.2.1.min.js"
        integrity="sha256-hwg4gsxgFZhOsEEamdOYGBf13FyQuiTwlAQgxVSNgt4="
        crossorigin="anonymous"></script>
        
        
	<script>
		$(document).ready(function(e) {
			$.getJSON("http://localhost:8000/testArr",function(data) {
				console.log(data);
				
				for(var i=0, len=data.length; i < len; i++) {
					
					
					
					var markerPosition  = new daum.maps.LatLng(data[i].lat, data[i].lng); 

					// 마커를 생성합니다
					var marker = new daum.maps.Marker({
					    position: markerPosition
					});
					
					 // 마커에 표시할 인포윈도우를 생성합니다 
				    var infowindow = new daum.maps.InfoWindow({
				        content: '<div><h1>'+data[i].sname+'</h1></div>' // 인포윈도우에 표시할 내용
				    });

				    // 마커에 mouseover 이벤트와 mouseout 이벤트를 등록합니다
				    // 이벤트 리스너로는 클로저를 만들어 등록합니다 
				    // for문에서 클로저를 만들어 주지 않으면 마지막 마커에만 이벤트가 등록됩니다
				    daum.maps.event.addListener(marker, 'mouseover', makeOverListener(map, marker, infowindow));
				    daum.maps.event.addListener(marker, 'mouseout', makeOutListener(infowindow));
					

					// 마커가 지도 위에 표시되도록 설정합니다
					marker.setMap(map);
					
				}
				
				// 인포윈도우를 표시하는 클로저를 만드는 함수입니다 
				function makeOverListener(map, marker, infowindow) {
				    return function() {
				        infowindow.open(map, marker);
				    };
				}

				// 인포윈도우를 닫는 클로저를 만드는 함수입니다 
				function makeOutListener(infowindow) {
				    return function() {
				        infowindow.close();
				    };
				}
				
			});	
		});
		
		
	</script>
</body>
</html>